name: Clear output

on: [push, pull_request]

jobs: 
    clear_output:
        runs-on: ubuntu-latest

        permissions:
            contents: write
            pull-requests: write

        steps:
        - name: Checkout repository
          uses: actions/checkout@v3

        - name: Set up Python
          uses: actions/setup-python@v3
          with:
            python-version: "3.10"

        - name: Install dependencies
          run: |
            python -m pip install --upgrade pip
            pip install jupyter

        - name: Clear IPython output
          run: |
            jupyter nbconvert --ClearOutputPreprocessor.enabled=True --inplace $(git ls-files '*.ipynb')
        - name: Commit changes
          uses: stefanzweifel/git-auto-commit-action@v5
          with:
            commit_message: Clear ipynb output
            commit_options: '--no-verify --signoff'
            file_pattern: '*.ipynb'
